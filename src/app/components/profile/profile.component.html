<div class="profile-page">
  <div class="profile-header">
    <h1>My Profile</h1>
    <p>Manage your account information</p>
  </div>

  <div *ngIf="isLoading" class="loading">
    <div class="spinner"> <img src="assets/loading.png" alt="loading" /></div>
    <p>Loading profile...</p>
  </div>

  <div class="profile-container" *ngIf="!isLoading && currentUser">
    <div class="profile-card">
      <div class="profile-avatar-section">
        <div class="avatar-circle">
          {{ getInitials() }}
        </div>
        <div class="user-info">
          <h2>{{ currentUser.name }}</h2>
          <span class="role-badge" [ngClass]="getRoleBadgeClass()">
            {{ currentUser.role }}
          </span>
        </div>
      </div>

      <div class="profile-form-section">
        <div class="section-header">
          <h3>Personal Information</h3>
          <button 
            *ngIf="!isEditMode" 
            class="btn-edit" 
            (click)="toggleEditMode()"
          >
            <lucide-icon name="edit-2" [size]="18"></lucide-icon>
            <span>Edit Profile</span>
          </button>
        </div>

        <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
          <div class="form-group">
            <label for="name">
              <lucide-icon name="user" [size]="18"></lucide-icon>
              Full Name
            </label>
            <input
              id="name"
              type="text"
              formControlName="name"
              [readonly]="!isEditMode"
              [class.readonly]="!isEditMode"
              placeholder="Enter your full name"
            />
            <div 
              class="error-message" 
              *ngIf="profileForm.get('name')?.invalid && profileForm.get('name')?.touched"
            >
              Name must be at least 2 characters
            </div>
          </div>

          <div class="form-group">
            <label for="email">
              <lucide-icon name="mail" [size]="18"></lucide-icon>
              Email Address
            </label>
            <input
              id="email"
              type="email"
              formControlName="email"
              [readonly]="!isEditMode"
              [class.readonly]="!isEditMode"
              placeholder="Enter your email"
            />
            <div 
              class="error-message" 
              *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched"
            >
              Please enter a valid email address
            </div>
          </div>

          <div class="form-actions" *ngIf="isEditMode">
            <button 
              type="button" 
              class="btn-cancel" 
              (click)="toggleEditMode()"
              [disabled]="isSaving"
            >
              Cancel
            </button>
            <button 
              type="submit" 
              class="btn-save" 
              [disabled]="profileForm.invalid || isSaving"
            >
              <lucide-icon name="check" [size]="18" *ngIf="!isSaving"></lucide-icon>
              <span *ngIf="!isSaving">Save Changes</span>
              <span *ngIf="isSaving">Saving...</span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

